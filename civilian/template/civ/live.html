<HTML>
<html lang="en">
  <script type="text/javascript" src="{{ STATIC_URL }}jquery.js"></script>
  <script type="text/javascript" src="{{ STATIC_URL }}bootstrap/js/bootstrap.js"></script>
  <link href="{{ STATIC_URL }}bootstrap/css/bootstrap.css" rel="stylesheet">
  <HEADER><meta charset="utf-8">
    <title>Civilian Live Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the bottom of the topbar */
      }
	  .progress{
	  margin-top: 30px;
	  width: 800px;
	  height: 40px;
	  }
    </style>
    <link href="{{ STATIC_URL }}bootstrap/css/bootstrap-responsive.css" rel="stylesheet">

  </HEADER>
 
   <BODY>
    {% if fact_list %}
    <div id="wrap">
      <!-- Fixed navbar -->
      <div class="navbar navbar-fixed-top">
        <div class="navbar-inner">
          <div class="container">
            <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="brand" href="/civ">Civilian</a>
            <div class="nav-collapse collapse">
              <ul class="nav">
                <li class="active"><a href="#">Live Screen</a></li>
              </ul>
            </div><!--/.nav-collapse -->
          </div>
        </div>
      </div>
	</div>
	<div class="container">
	  <h1> FACTION TOTAL POINTS </h1>
	  <div class="progress active progress-striped">
		{% for fact in fact_list %}
		<div class="{{fact.bar}}" style="width:{{fact.perc}}%;"><p class="lead">{{fact.name}}: {{fact.score}}</p></div>
		{% endfor %}
	  </div>
	</div>
    {% else %}
    <P> NO FACTIONS EXIST!</P>
    {% endif %}
	<script>
	  var progress = setInterval(function() {
	  var $bar = $('.blue');
	  
	  if ($bar.width()==250) {
	  clearInterval(progress);
	  $('.progress').removeClass('active');
	  } else {
	  $bar.width($bar.width()+50);
	  }
	  $bar.text($bar.width()*2/5 + "%");
	  }, 800);
	  
	  (function worker() {
	  $.ajax({ type: "GET",
      url: "/civ/updatelive", 
      success: function(ret) {
	  obj = JSON.parse(ret);
      },
      complete: function() {
      // Schedule the next request when the current one's complete
      setTimeout(worker, 500);
      }
	  });
	  })();
	  
	</script>
   </BODY>
</HTML>   
   
